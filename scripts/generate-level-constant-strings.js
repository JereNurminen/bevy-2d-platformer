import * as fs from "fs";

const ldtkData = fs.readFileSync("assets/ldtk/project.ldtk", "utf8");
const world = JSON.parse(ldtkData);

const enumPairs = world.toc.map((e) => [
  e.identifier,
  e.identifier.toUpperCase(),
]);
const layerIdentifiers = world.defs.layers.map((e) => [
  e.identifier,
  e.identifier.toUpperCase(),
]);

const pairToRow = (prefix) => (pair) =>
  `pub const ${prefix}__${pair[1]}: &str = "${pair[0]}";`;

const rows = [
  "// generated by scripts/generate-level-constant-strings.js",
  "\n// Entities:",
  ...enumPairs.map(pairToRow("E")),
  "\n// Layers:",
  ...layerIdentifiers.map(pairToRow("L")),
].join("\n");
console.log(rows);

fs.writeFileSync("src/level_enums.rs", rows);
